# Maintainer: pdq <pdq@localhost>
pkgname=moo-tools
pkgver=0.21
pkgrel=1
pkgdesc="Installer for mooOS using dialog."
arch=(any)
url="https://github.com/idk/mooOS-dev-tools.git"
license=('GPL3')
makedepends=('git')
depends=('dialog' 'rsync' 'arch-install-scripts' 'update-mirrorlist' 'efl-git' 'gtk3' 'hicolor-icon-theme' 'desktop-file-utils')
#conflicts=('abc' 'xyz')
#source=("")
#md5sums=('SKIP')

_gitroot="git://github.com/idk/mooOS-dev-tools.git"
_gitname="moo-tools"

install=$pkgname.install

build() {
	cd "$srcdir"
	msg "Connecting to GIT server...."

	if [ -d $pkgname ] ; then
		cd $pkgname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot $pkgname
		cd $pkgname
	fi
	msg "GIT checkout done or server timeout"
}

package() {
	cd "$srcdir/$pkgname/"
	msg2 "Installing mooOS development tools ${pkgver}."
    install -d "$srcdir/$pkgname/" "${pkgdir}/usr/share/$pkgname"
	msg2 "Installing executables."
	install -d "$pkgdir/usr/bin"
	cp "installer/moo_installer" "$pkgdir/usr/bin/moo_installer"
	cp "installer/moo_chroot" "$pkgdir/usr/bin/moo_chroot"
	install -Dm644 "misc/man.1" "$pkgdir/usr/local/man/man1/mooOS.1"
	install -Dm644 "applications/moo_os_installer.desktop" "$pkgdir/usr/share/applications/moo_os_installer.desktop"
	gzip -f "$pkgdir/usr/local/man/man1/mooOS.1"
}