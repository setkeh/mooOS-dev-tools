# Maintainer: pdq <pdq@localhost>
pkgname=moo-tools
pkgver=0.21
pkgrel=5
pkgdesc="Installer for mooOS using dialog."
arch=(any)
url="https://github.com/idk/mooOS-dev-tools.git"
license=('GPL3')
makedepends=('git')
depends=('moo-scripts' 'dialog' 'rsync' 'arch-install-scripts' 'update-mirrorlist' 'efl-git' 'gtk3' 'hicolor-icon-theme' 'desktop-file-utils')
#conflicts=('abc' 'xyz')
#source=("")
#md5sums=('SKIP')

_gitroot="git://github.com/idk/mooOS-dev-tools.git"
_gitname="moo-tools"

install=$pkgname.install

build() {
	cd "$srcdir"
	msg "Connecting to GIT server...."

	if [ -d $pkgname ] ; then
		cd $pkgname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot $pkgname
		cd $pkgname
	fi
	msg "GIT checkout done or server timeout"
}

package() {
	cd "$srcdir/$pkgname/"
	msg2 "Installing mooOS development tools ${pkgver}."
    install -d "${pkgdir}/usr/share/$pkgname"
    cp -r "$srcdir/$pkgname/" "${pkgdir}/usr/share/"
	msg2 "Installing executables."
	install -D -m 755 "installer/moo_installer" "$pkgdir/usr/bin/moo_installer"
	install -D -m 755 "installer/moo_chroot" "$pkgdir/usr/bin/moo_chroot"
	install -D -m 644 "create_iso/moo_config" "$pkgdir/etc/moo.cfg"
	install -D -m 755 "create_iso/mkiso" "$pkgdir/usr/bin/mkiso"
	install -Dm644 "misc/man.1" "$pkgdir/usr/local/man/man1/mooOS.1"
	install -Dm644 "applications/moo_os_installer.desktop" "$pkgdir/usr/share/applications/moo_os_installer.desktop"
	install -Dm644 "applications/man_mooOS.desktop" "$pkgdir/usr/share/applications/man_mooOS.desktop"
	gzip -f "$pkgdir/usr/local/man/man1/mooOS.1"
}